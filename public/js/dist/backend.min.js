
$(document).ready(function(){
    var fadeSuccessMessages=function(){
        $(".alert-success").delay(2000).slideUp(500,function(){
            this.remove();
        });
    };
    /** Globaler Message Handler **/
    //AJAX-Response==JSON[msg]?set message
    $(document).ajaxSuccess(function (e, req) {
        if (req.responseJSON && req.responseJSON.msg ) {
            var messages=req.responseJSON.msg;
            var messageTypes={
                error:{
                    typeClass:"alert-danger",
                    title: "Fehler"
                },
                warning:{
                    typeClass:"alert-warning",
                    title: "Achtung"
                },
                success:{
                    typeClass:"alert-success",
                    title: "Erfolg"
                }
            };
            for(var type in messageTypes){
                messages[type].forEach(function (msg) {
                    var htmlMsg=$('<div class="alert '+messageTypes[type]["typeClass"]+' alert-dismissible" role="alert">' +
                    '<button type="button" class="close" data-dismiss="alert" aria-label="Close">' +
                    '<span aria-hidden="true">&times;</span>' +
                    '</button>' +
                    '<strong>'+messageTypes[type]["title"]+'</strong> ' + msg+
                    '</div>').hide();
                    //Modal-Fenster?
                    var modal=$(".modal-dialog");
                    if(modal.length){
                        modal.prepend(htmlMsg);
                    }else{
                        $("main").prepend(htmlMsg);
                    }
                    htmlMsg.slideDown(500);
                    //autofadeout vom erfolgsmeldungen
                    fadeSuccessMessages();
                });
            }
        }
    });
    /** Neue Frucht **/
    $(document).on("click","#newFruitPhoto",function(e){
        e.preventDefault();
        $("#fruitphoto").trigger("click");
    }).on("change","#fruitphoto",function(){
        var data = new FormData();
        data.append($(this).attr("name"), this.files[0]);
        $(this).val(""); //IE-Bug

        var formular = $(this).parents("form");
        var targetUrl = formular.attr("action");

        $.ajax({
            url: targetUrl,
            data: data,
            cache: false,
            method: formular.attr("method"),
            contentType: false,
            processData: false,
            type: 'POST',
            success: function (data) {
                if(data.preview && data.token) {
                    $("#fruit_label").attr("src", "data:image/jpg;base64," + data["preview"]);
                    $("#token").val(data.token);
                }
            }
        });
    })
    //Leere Modal-Fenster nach Schließen
    .on("hidden.bs.modal","#newFruit", function (e) {
        $(e.target).removeData('bs.modal');
    });

    //Lade Bild nicht nochmals hoch
    $('form#fruits').on("submit",function(){
       $(this).find('input[type="file"]').prop("disabled",true);
        return true;
    });

    //colorpicker
    $(function(){
        $('#fruits #color').colorpicker().on("changeColor",function(e){
            var clr;
            if(e.color!=undefined){
                clr=e.color.toHex();
            }else{
                clr=$(this).val();

            }
            $(this).css({backgroundColor:clr});
        }).trigger("changeColor");
    });
    //Lösche Frucht
    $(".fruit-delete").confirmation(
        {
            title:"Sind Sie sicher?",
            singleton: true,
            onConfirm:function(){
                var v=$(this).val();
                var target="/fruit/del";

                $.post(target)
            }


        }

    );

    //Fadeout on load
    fadeSuccessMessages();
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2VuZC5taW4uanMiLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJiYWNrZW5kLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKXtcbiAgICB2YXIgZmFkZVN1Y2Nlc3NNZXNzYWdlcz1mdW5jdGlvbigpe1xuICAgICAgICAkKFwiLmFsZXJ0LXN1Y2Nlc3NcIikuZGVsYXkoMjAwMCkuc2xpZGVVcCg1MDAsZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgLyoqIEdsb2JhbGVyIE1lc3NhZ2UgSGFuZGxlciAqKi9cbiAgICAvL0FKQVgtUmVzcG9uc2U9PUpTT05bbXNnXT9zZXQgbWVzc2FnZVxuICAgICQoZG9jdW1lbnQpLmFqYXhTdWNjZXNzKGZ1bmN0aW9uIChlLCByZXEpIHtcbiAgICAgICAgaWYgKHJlcS5yZXNwb25zZUpTT04gJiYgcmVxLnJlc3BvbnNlSlNPTi5tc2cgKSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZXM9cmVxLnJlc3BvbnNlSlNPTi5tc2c7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZVR5cGVzPXtcbiAgICAgICAgICAgICAgICBlcnJvcjp7XG4gICAgICAgICAgICAgICAgICAgIHR5cGVDbGFzczpcImFsZXJ0LWRhbmdlclwiLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJGZWhsZXJcIlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgd2FybmluZzp7XG4gICAgICAgICAgICAgICAgICAgIHR5cGVDbGFzczpcImFsZXJ0LXdhcm5pbmdcIixcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiQWNodHVuZ1wiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOntcbiAgICAgICAgICAgICAgICAgICAgdHlwZUNsYXNzOlwiYWxlcnQtc3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJFcmZvbGdcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IodmFyIHR5cGUgaW4gbWVzc2FnZVR5cGVzKXtcbiAgICAgICAgICAgICAgICBtZXNzYWdlc1t0eXBlXS5mb3JFYWNoKGZ1bmN0aW9uIChtc2cpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWxNc2c9JCgnPGRpdiBjbGFzcz1cImFsZXJ0ICcrbWVzc2FnZVR5cGVzW3R5cGVdW1widHlwZUNsYXNzXCJdKycgYWxlcnQtZGlzbWlzc2libGVcIiByb2xlPVwiYWxlcnRcIj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBkYXRhLWRpc21pc3M9XCJhbGVydFwiIGFyaWEtbGFiZWw9XCJDbG9zZVwiPicgK1xuICAgICAgICAgICAgICAgICAgICAnPHNwYW4gYXJpYS1oaWRkZW49XCJ0cnVlXCI+JnRpbWVzOzwvc3Bhbj4nICtcbiAgICAgICAgICAgICAgICAgICAgJzwvYnV0dG9uPicgK1xuICAgICAgICAgICAgICAgICAgICAnPHN0cm9uZz4nK21lc3NhZ2VUeXBlc1t0eXBlXVtcInRpdGxlXCJdKyc8L3N0cm9uZz4gJyArIG1zZytcbiAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy9Nb2RhbC1GZW5zdGVyP1xuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kYWw9JChcIi5tb2RhbC1kaWFsb2dcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmKG1vZGFsLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5wcmVwZW5kKGh0bWxNc2cpO1xuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICQoXCJtYWluXCIpLnByZXBlbmQoaHRtbE1zZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaHRtbE1zZy5zbGlkZURvd24oNTAwKTtcbiAgICAgICAgICAgICAgICAgICAgLy9hdXRvZmFkZW91dCB2b20gZXJmb2xnc21lbGR1bmdlblxuICAgICAgICAgICAgICAgICAgICBmYWRlU3VjY2Vzc01lc3NhZ2VzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICAvKiogTmV1ZSBGcnVjaHQgKiovXG4gICAgJChkb2N1bWVudCkub24oXCJjbGlja1wiLFwiI25ld0ZydWl0UGhvdG9cIixmdW5jdGlvbihlKXtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAkKFwiI2ZydWl0cGhvdG9cIikudHJpZ2dlcihcImNsaWNrXCIpO1xuICAgIH0pLm9uKFwiY2hhbmdlXCIsXCIjZnJ1aXRwaG90b1wiLGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBkYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGRhdGEuYXBwZW5kKCQodGhpcykuYXR0cihcIm5hbWVcIiksIHRoaXMuZmlsZXNbMF0pO1xuICAgICAgICAkKHRoaXMpLnZhbChcIlwiKTsgLy9JRS1CdWdcblxuICAgICAgICB2YXIgZm9ybXVsYXIgPSAkKHRoaXMpLnBhcmVudHMoXCJmb3JtXCIpO1xuICAgICAgICB2YXIgdGFyZ2V0VXJsID0gZm9ybXVsYXIuYXR0cihcImFjdGlvblwiKTtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiB0YXJnZXRVcmwsXG4gICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgbWV0aG9kOiBmb3JtdWxhci5hdHRyKFwibWV0aG9kXCIpLFxuICAgICAgICAgICAgY29udGVudFR5cGU6IGZhbHNlLFxuICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLFxuICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZihkYXRhLnByZXZpZXcgJiYgZGF0YS50b2tlbikge1xuICAgICAgICAgICAgICAgICAgICAkKFwiI2ZydWl0X2xhYmVsXCIpLmF0dHIoXCJzcmNcIiwgXCJkYXRhOmltYWdlL2pwZztiYXNlNjQsXCIgKyBkYXRhW1wicHJldmlld1wiXSk7XG4gICAgICAgICAgICAgICAgICAgICQoXCIjdG9rZW5cIikudmFsKGRhdGEudG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSlcbiAgICAvL0xlZXJlIE1vZGFsLUZlbnN0ZXIgbmFjaCBTY2hsaWXDn2VuXG4gICAgLm9uKFwiaGlkZGVuLmJzLm1vZGFsXCIsXCIjbmV3RnJ1aXRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgJChlLnRhcmdldCkucmVtb3ZlRGF0YSgnYnMubW9kYWwnKTtcbiAgICB9KTtcblxuICAgIC8vTGFkZSBCaWxkIG5pY2h0IG5vY2htYWxzIGhvY2hcbiAgICAkKCdmb3JtI2ZydWl0cycpLm9uKFwic3VibWl0XCIsZnVuY3Rpb24oKXtcbiAgICAgICAkKHRoaXMpLmZpbmQoJ2lucHV0W3R5cGU9XCJmaWxlXCJdJykucHJvcChcImRpc2FibGVkXCIsdHJ1ZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuXG4gICAgLy9jb2xvcnBpY2tlclxuICAgICQoZnVuY3Rpb24oKXtcbiAgICAgICAgJCgnI2ZydWl0cyAjY29sb3InKS5jb2xvcnBpY2tlcigpLm9uKFwiY2hhbmdlQ29sb3JcIixmdW5jdGlvbihlKXtcbiAgICAgICAgICAgIHZhciBjbHI7XG4gICAgICAgICAgICBpZihlLmNvbG9yIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIGNscj1lLmNvbG9yLnRvSGV4KCk7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBjbHI9JCh0aGlzKS52YWwoKTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJCh0aGlzKS5jc3Moe2JhY2tncm91bmRDb2xvcjpjbHJ9KTtcbiAgICAgICAgfSkudHJpZ2dlcihcImNoYW5nZUNvbG9yXCIpO1xuICAgIH0pO1xuICAgIC8vTMO2c2NoZSBGcnVjaHRcbiAgICAkKFwiLmZydWl0LWRlbGV0ZVwiKS5jb25maXJtYXRpb24oXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOlwiU2luZCBTaWUgc2ljaGVyP1wiLFxuICAgICAgICAgICAgc2luZ2xldG9uOiB0cnVlLFxuICAgICAgICAgICAgb25Db25maXJtOmZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyIHY9JCh0aGlzKS52YWwoKTtcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0PVwiL2ZydWl0L2RlbFwiO1xuXG4gICAgICAgICAgICAgICAgJC5wb3N0KHRhcmdldClcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH1cblxuICAgICk7XG5cbiAgICAvL0ZhZGVvdXQgb24gbG9hZFxuICAgIGZhZGVTdWNjZXNzTWVzc2FnZXMoKTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9